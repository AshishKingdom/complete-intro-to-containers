{
    "componentChunkName": "component---src-templates-lesson-template-js",
    "path": "/static-assets-project",
    "result": {"data":{"markdownRemark":{"html":"<p>We're going to do a project now! Free to attempt the project first and then follow along with me as I code the answer.</p>\n<p>We're going to construct a very basic front end website with React, TypeScript, and Sass. Why these? Because I want it to have a lot of dependencies and a big build step. This class isn't about any of these things (and I don't personally endorse the use of Sass anymore though I respect those who do.) If you want to take a class on React, my <a href=\"https://frontendmasters.com/courses/complete-react-v5/\">intro</a> and <a href=\"https://frontendmasters.com/courses/intermediate-react-v2/\">intermediate</a> classes are available on Frontend Masters.</p>\n<p>We're going to create a new project using <a href=\"https://create-react-app.dev\">create-react-app</a>. Go to the directory where you want to create the new project (CRA will create the folder for you) and run <code class=\"language-text\">npx --ignore-existing create-react-app static-assets-project --template typescript --use-npm</code>. Do note: create-react-app has been having issues with global installs of create-react-app. If you have it install globally right now, please uninstall it and use the above command.</p>\n<p>This will scaffold out a whole new TypeScript React project for you.</p>\n<p><strong>OPTIONAL:</strong> Go into the project and run <code class=\"language-text\">npm install node-sass</code>. This will install the Sass compiler for you. Go change both of the <code class=\"language-text\">.css</code> files in this project to have the <code class=\"language-text\">.scss</code> extensions (everything that's valid in CSS is valid in SCSS.) Update the two <code class=\"language-text\">.css</code> imports in <code class=\"language-text\">App.tsx</code> and <code class=\"language-text\">index.tsx</code> to have `.scss imports instead. If you're struggling with the Sass stuff, feel free to leave it out and just go with an out-of-the-box CRA app, the Sass stuff is just to drive home the point that you can have as many dependencies as you want.</p>\n<p>To make sure this works right now, run <code class=\"language-text\">npm run start</code> in your console and make sure the app starts okay. You should see a splash screen. Once you're ready to build it, run <code class=\"language-text\">npm run build</code> to have it build for production.</p>\n<p>The project is to make a multi-stage Dockerfile that build the project in one container and then serves it from a different container using NGINX. If you're not familiar with NGINX, fear not! It is a static file server, which is to say it take takes HTML, CSS, JS, images, fonts, etc. and serves them to your users. It handles all the serving and file headers for you. Using it can be accomplished in few steps. You'll use the <code class=\"language-text\">nginx:latest</code> (or <code class=\"language-text\">nginx:alpine</code>! up to you) container and copy <strong>just the newly built files, not everything</strong> (which is in the <code class=\"language-text\">build</code> directory inside of the CRA app) to <code class=\"language-text\">/usr/share/nginx/html</code> and the <code class=\"language-text\">nginx</code> will take care of the rest. The <code class=\"language-text\">nginx</code> container defines <code class=\"language-text\">CMD</code> in it and if you don't override it, it starts NGINX for you. Give it a shot! Once you've tried, come back here and we'll do the solution together. NGINX runs on port 80 by default, so you probably want to route that something like 8080 on your host machine (otherwise you have to run it as root which no one wants to do.)</p>\n<p>Scroll down to see my answer.</p>\n<div style=\"height: 600px\"></div>\n<p>Done? If you gave it a shot, your Dockerfile probably shouldn't very long. Let's see what I came up with</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> node:latest</span>\n<span class=\"token instruction\"><span class=\"token keyword\">WORKDIR</span> /app</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> . .</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> npm ci &amp;&amp; npm run build</span>\n\n<span class=\"token comment\"># you could totally use nginx:alpine here too</span>\n<span class=\"token instruction\"><span class=\"token keyword\">FROM</span> nginx:latest</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> <span class=\"token options\"><span class=\"token property\">--from</span><span class=\"token punctuation\">=</span><span class=\"token string\">0</span></span> /app/build /usr/share/nginx/html</span></code></pre></div>\n<p>Now if you run this, it should work:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> build -t static-app <span class=\"token builtin class-name\">.</span>\n<span class=\"token function\">docker</span> run -p <span class=\"token number\">8080</span>:80 static-app</code></pre></div>\n<p>It should be working now! Hooray! Hopefully you're starting to see the power of what Docker can unlock for you.</p>","frontmatter":{"path":"/static-assets-project","title":"Static Assets Project","order":5.3,"section":"Making Tiny Containers","description":"Brian gives an exercise to make the create-react-app app be served by NGINX so that it's understandable how to pull into someone else's container they've built and build on top of it."}},"allMarkdownRemark":{"edges":[{"node":{"frontmatter":{"order":1,"path":"/intro","title":"Introduction"}}},{"node":{"frontmatter":{"order":2,"path":"/what-are-containers","title":"What Are Containers?"}}},{"node":{"frontmatter":{"order":2.1,"path":"/chroot","title":"chroot"}}},{"node":{"frontmatter":{"order":2.2,"path":"/namespaces","title":"Namespaces"}}},{"node":{"frontmatter":{"order":2.3,"path":"/cgroups","title":"cgroups"}}},{"node":{"frontmatter":{"order":3,"path":"/getting-set-up-with-docker","title":"Getting Set Up with Docker"}}},{"node":{"frontmatter":{"order":3.1,"path":"/docker-images-without-docker","title":"Docker Images without Docker"}}},{"node":{"frontmatter":{"order":3.2,"path":"/docker-images-with-docker","title":"Docker Images with Docker"}}},{"node":{"frontmatter":{"order":3.3,"path":"/nodejs-on-docker","title":"Node.js on Docker"}}},{"node":{"frontmatter":{"order":3.4,"path":"/tags","title":"Tags"}}},{"node":{"frontmatter":{"order":3.5,"path":"/docker-cli","title":"Docker CLI"}}},{"node":{"frontmatter":{"order":4,"path":"/dockerfile","title":"Intro to Dockerfiles"}}},{"node":{"frontmatter":{"order":4.1,"path":"/build-a-nodejs-app","title":"Build a Node.js App"}}},{"node":{"frontmatter":{"order":4.2,"path":"/more-complicated-nodejs-app","title":"A More Complicated Node.js App"}}},{"node":{"frontmatter":{"order":4.4,"path":"/expose","title":"A Note on EXPOSE"}}},{"node":{"frontmatter":{"order":4.5,"path":"/layers","title":"Layers"}}},{"node":{"frontmatter":{"order":5,"path":"/alpine-linux","title":"Alpine Linux"}}},{"node":{"frontmatter":{"order":5.1,"path":"/making-our-own-alpine-nodejs-container","title":"Making Our Own Alpine Node.js Container"}}},{"node":{"frontmatter":{"order":5.2,"path":"/multi-stage-builds","title":"Multi Stage Builds"}}},{"node":{"frontmatter":{"order":5.3,"path":"/static-assets-project","title":"Static Assets Project"}}},{"node":{"frontmatter":{"order":6,"path":"/bind-mounts","title":"Bind Mounts"}}},{"node":{"frontmatter":{"order":6.1,"path":"/volumes","title":"Volumes"}}},{"node":{"frontmatter":{"order":6.2,"path":"/dev-containers","title":"Using Containers for your Dev Environment"}}},{"node":{"frontmatter":{"order":6.3,"path":"/visual-studio-code","title":"Dev Containers with Visual Studio Code"}}},{"node":{"frontmatter":{"order":6.4,"path":"/networking","title":"Networking with Docker"}}},{"node":{"frontmatter":{"order":7,"path":"/docker-compose","title":"Docker Compose"}}},{"node":{"frontmatter":{"order":7.1,"path":"/kubernetes","title":"Kubernetes"}}},{"node":{"frontmatter":{"order":7.2,"path":"/kompose","title":"Kompose"}}},{"node":{"frontmatter":{"order":8,"path":"/buildah","title":"Buildah"}}},{"node":{"frontmatter":{"order":8.1,"path":"/podman","title":"Podman"}}},{"node":{"frontmatter":{"order":9,"path":"/conclusion","title":"Conclusion"}}}]}},"pageContext":{}},
    "staticQueryHashes": ["2959687377"]}